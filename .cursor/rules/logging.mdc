---
description: Logging standards and conventions for sequential initialization and data flow visibility
alwaysApply: true
---

# Logging Standards

## Sequential Initialization Logging

**Purpose:** Provide 100% visibility into app initialization and data loading flow.

**Format:** `[INIT-N]` or `[DATA-N]` prefix with icons and concise messages.

### Initialization Steps (INIT)

- **INIT-1**: Amplify configuration (synchronous)
- **INIT-2**: RootLayout bootstrap start
- **INIT-3**: Task-system runtime initialization
- **INIT-4**: AWS DataStore start
- **INIT-5**: Temp answer sync service configuration
- **INIT-6**: Auto-flush service start
- **INIT-7**: All initialization complete

### Data Loading Steps (DATA)

- **DATA-1**: Task data subscription and loading
- **DATA-2**: Appointment data loading
- **DATA-3**: Other data model loading (Questions, Activities, etc.)

## Icon Conventions

**ALWAYS use icons to identify log sources:**

- **üöÄ** - Starting/initialization
- **‚úÖ** - Success/completion
- **‚ùå** - Error/failure
- **‚ö†Ô∏è** - Warning
- **‚òÅÔ∏è** - AWS DataStore/cloud operations
- **üîê** - Authentication/configuration
- **‚öôÔ∏è** - Configuration/setup
- **üìã** - Task data
- **üìÖ** - Appointment data
- **üíæ** - Storage/persistence
- **üîÑ** - Sync/retry operations
- **üì§** - Sending/uploading
- **üì•** - Receiving/downloading
- **üóëÔ∏è** - Deletion/cleanup

## Log Message Format

**Format:** `[ICON] [PLATFORM] [STEP] ServiceName: Concise message`

**Platform must ALWAYS be included:** `[iOS]`, `[Android]`, or `[Web]`

**Examples:**
- ‚úÖ Good: `‚òÅÔ∏è [iOS] [INIT-4] Bootstrap: AWS DataStore started - ready for cloud sync`
- ‚úÖ Good: `üìã [Android] [DATA-1] useTaskList: Received 5 tasks (synced-with-cloud)`
- ‚úÖ Good: `üíæ [Web] [TempAnswerSyncService] Service configured`
- ‚ùå Bad: `‚òÅÔ∏è [INIT-4] Bootstrap: AWS DataStore started` (missing platform)
- ‚ùå Bad: `[TaskService] Setting up DataStore subscription` (no icon, no platform, no step)
- ‚ùå Bad: `Task created` (no context, no service name, no platform)

## Logging Rules

### DO

- **ALWAYS include platform** (`[iOS]`, `[Android]`, or `[Web]`) in every log message
- **Use step numbers** (`[INIT-N]`, `[DATA-N]`) for sequential operations
- **Include icons** to quickly identify log source and type
- **Be concise** - log essential info only, not full objects
- **Use AWS icons (‚òÅÔ∏è)** for all DataStore/AWS operations
- **Log data counts** instead of full arrays: `Loaded 5 tasks` not `Loaded [full array]`
- **Include status indicators**: `synced-with-cloud`, `local-only`, `queued-for-retry`
- **Use `platformLogger.ts` utilities** (`logWithPlatform`, `logErrorWithPlatform`) for consistent formatting

### DON'T

- **Don't log without platform identification** - every log must include `[iOS]`, `[Android]`, or `[Web]`
- **Don't use raw `console.log`** - use `logWithPlatform` or `logErrorWithPlatform` from `platformLogger.ts`
- **Don't log full JSON objects** - extract key values only
- **Don't log on every render** - only log state changes and operations
- **Don't log navigation menu rendering** - not part of data flow
- **Don't use generic icons** - use specific icons for context
- **Don't log without step numbers** for initialization/data flow

## Concise Logging Examples

**Before (verbose):**
```typescript
console.log("[AppointmentService] Parsed AsyncStorage data", {
  hasClinicPatientAppointments: !!parsed.clinicPatientAppointments,
  hasClinicAppointments: !!parsed.clinicPatientAppointments?.clinicAppointments,
  itemsCount: parsed.clinicPatientAppointments?.clinicAppointments?.items?.length || 0,
  siteTimezoneId: parsed.siteTimezoneId,
  sampleItems: parsed.clinicPatientAppointments?.clinicAppointments?.items?.slice(0, 2).map(...),
});
```

**After (concise with platform):**
```typescript
import { logWithPlatform } from "../utils/platformLogger";

const itemsCount = parsed.clinicPatientAppointments?.clinicAppointments?.items?.length || 0;
logWithPlatform("üìÖ", "DATA-2", "AppointmentService", `Loaded ${itemsCount} appointments from AsyncStorage`, {
  timezone: parsed.siteTimezoneId
});
```

## Sequential Flow Example

```
üöÄ [iOS] [INIT-1] AmplifyInit: Starting Amplify configuration (synchronous)
üîê [iOS] [INIT-1] AmplifyConfig: Amplify configured with API_KEY authentication
‚úÖ [iOS] [INIT-1] AmplifyConfig: Amplify configuration complete
üöÄ [iOS] [INIT-2] RootLayout: Starting task system bootstrap
üöÄ [iOS] [INIT-3] Bootstrap: Initializing task-system runtime
‚öôÔ∏è [iOS] [INIT-3.1] TaskSystem: Configuring conflict resolution
‚úÖ [iOS] [INIT-3.1] TaskSystem: Conflict resolution configured
‚úÖ [iOS] [INIT-3] Bootstrap: Task-system runtime initialized
‚òÅÔ∏è [iOS] [INIT-4] Bootstrap: Starting AWS DataStore
‚òÅÔ∏è [iOS] [INIT-4] Bootstrap: AWS DataStore started - ready for cloud sync
üöÄ [iOS] [INIT-5] Bootstrap: Configuring temp answer sync service
üíæ [iOS] TempAnswerSyncService: Service configured
‚úÖ [iOS] [INIT-5] Bootstrap: Temp answer sync service configured
üöÄ [iOS] [INIT-6] Bootstrap: Starting auto-flush for queued temp answers
‚úÖ [iOS] [INIT-6] Bootstrap: Auto-flush started - will retry queued items on network online
‚úÖ [iOS] [INIT-7] Bootstrap: All initialization complete - data services ready
‚úÖ [iOS] [INIT-2] RootLayout: Task system bootstrap complete - app ready to render
üìã [iOS] [DATA-1] useTaskList: Subscribing to task data
‚òÅÔ∏è [iOS] [DATA-1.1] TaskService: Setting up AWS DataStore subscription for Task model
‚òÅÔ∏è [iOS] [DATA-1.1] TaskService: Initial AWS DataStore query completed - 3 tasks loaded
üìã [iOS] [DATA-1] useTaskList: Received 3 tasks (synced-with-cloud)
üìÖ [iOS] [DATA-2] useAppointmentList: Loading appointments (today only)
üìÖ [iOS] [DATA-2] AppointmentService: Loaded 2 appointments from AsyncStorage
üìÖ [iOS] [DATA-2] useAppointmentList: Loaded 2 appointments (todayOnly: true)
```

## Error Logging

**Format:** `‚ùå [PLATFORM] [STEP] ServiceName: Failed to [action] - error message`

**Examples:**
- `‚ùå [iOS] [INIT-1] AmplifyConfig: Failed to configure Amplify - API key missing`
- `‚ùå [Android] [DATA-1.1] TaskService: Initial AWS DataStore query failed - Network error`
- `‚ùå [Web] [DATA] TaskService: Failed to create task in AWS DataStore - Validation error`

**Never log full error objects** - extract message only:
- ‚úÖ Good: Use `logErrorWithPlatform` which automatically extracts error messages
- ‚úÖ Good: `error instanceof Error ? error.message : String(error)`
- ‚ùå Bad: `error` (logs full stack trace and object)
- ‚ùå Bad: `console.error("Error:", error)` (missing platform, missing format)

## Centralized Logging Service

**ALWAYS use the centralized logging service** via the `useLogger` hook to ensure platform identification and consistent formatting:

**For React components and hooks:**
```typescript
import { useLogger } from "../hooks/useLogger";

const MyComponent = () => {
  const logger = useLogger();

  // For regular logs
  logger.info("AWS DataStore started - ready for cloud sync", undefined, "Bootstrap", "INIT-4", "‚òÅÔ∏è");

  // For errors
  logger.error("Failed to configure Amplify", error, "AmplifyConfig", "INIT-1");
};
```

**For services and utilities (non-React code):**
```typescript
import { getLoggingService } from "../services/LoggingService";

const logger = getLoggingService();

// For regular logs
logger.info("AWS DataStore started - ready for cloud sync", undefined, "Bootstrap", "INIT-4", "‚òÅÔ∏è");

// For errors
logger.error("Failed to configure Amplify", error, "AmplifyConfig", "INIT-1");
```

**Service-specific logger (recommended for services):**
```typescript
import { getLoggingService } from "../services/LoggingService";

const logger = getLoggingService().createLogger("TaskService");

// Now all logs automatically use "TaskService" as service name
logger.info("Task created", { taskId: "123" }, "DATA-1", "üìã");
logger.error("Failed to create task", error);
```

**The centralized logging service provides:**
- Automatic platform detection (`[iOS]`, `[Android]`, or `[Web]`)
- Consistent formatting across all logs
- Multiple log providers (console, native, Sentry)
- Native logging support for offline testing (adb logcat)
- Type-safe TypeScript interfaces
- Extensible provider architecture

**Migration from platformLogger:**
- During migration, `platformLogger` utilities are still available for backward compatibility
- New code should use `useLogger` hook or `getLoggingService()`
- Existing code can be gradually migrated

**NEVER use raw `console.log` or `console.error`** - always use the centralized logging service.

üìñ **For detailed documentation**, see [Logging Service Documentation](DOCS/development/logging-service.md)
