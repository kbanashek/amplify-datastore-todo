# This "input" configures a global authorization rule to enable public access to
# all models in this schema. Learn more about authorization rules here: https://docs.amplify.aws/cli/graphql/authorization-rules
input AMPLIFY {
  globalAuthRule: AuthRule = { allow: public }
} # FOR TESTING ONLY!
enum TaskType {
  SCHEDULED
  TIMED
  EPISODIC
}

enum TaskStatus {
  OPEN
  VISIBLE
  STARTED
  INPROGRESS
  COMPLETED
  EXPIRED
  RECALLED
}

type Task @model @auth(rules: [{ allow: public }]) {
  id: ID!
  # Core identifiers
  pk: String!
  sk: String!
  taskInstanceId: String

  # Content
  title: String!
  description: String

  # Timing
  startTime: String
  startTimeInMillSec: AWSTimestamp
  expireTimeInMillSec: AWSTimestamp
  endTimeInMillSec: AWSTimestamp
  endTime: String
  dayOffset: Int
  endDayOffset: Int

  # Task Type
  taskType: TaskType!

  # Status
  status: TaskStatus!

  # Completion Rules
  showBeforeStart: Boolean
  allowEarlyCompletion: Boolean
  allowLateCompletion: Boolean
  allowLateEdits: Boolean

  # Anchors & Actions (stored as JSON strings)
  anchors: String
  anchorDayOffset: Int
  actions: String

  # Activity Reference
  entityId: String
  activityIndex: Int
  activityAnswer: String
  activityResponse: String

  # Sync State
  syncState: Int
  syncStateTaskAnswer: Int
  syncStateTaskResult: Int
  syncStatus: String

  # Relationships
  hashKey: String
  occurrenceHashKey: String
  occurrenceParentHashKey: String
  parentTaskInstanceId: String
  tciSk: String

  # Study Information
  studyVersion: String
  studyStatus: String
}

type Question @model @auth(rules: [{ allow: public }]) {
  id: ID!
  pk: String!
  sk: String!
  question: String!
  questionId: String!
  questionText: String
  questionEnText: String
  friendlyName: String!
  answer: String
  controlType: String!
  type: String
  validations: String
  codedSelection: String
  answerId: String
  answersValue: String
  answerEnText: String
  answerCodedValue: String
  answersImages: String
  value: String
  codedValue: Int
  imageS3Key: String
  multiSelectOverride: String
  version: Int!
  index: Int!
}

type Activity @model @auth(rules: [{ allow: public }]) {
  id: ID!
  pk: String!
  sk: String!
  name: String
  title: String
  description: String
  type: String
  activityGroups: String
  layouts: String
  rules: String
  resumable: Boolean
  transcribable: Boolean
  respondentType: String
  progressBar: Boolean
  displayHistoryDetail: String
  fontFamily: String
  fontWeight: Int
  fontColor: String
  fontSize: Int
  lineHeight: String
  s3Files: String
  externalContent: String
  calculatedValues: String
}

type DataPoint @model @auth(rules: [{ allow: public }]) {
  id: ID!
  pk: String!
  sk: String!
  dataPointKey: String
  type: String
  anchors: String
}

type DataPointInstance @model @auth(rules: [{ allow: public }]) {
  id: ID!
  pk: String!
  sk: String!
  dataPointKey: String
  type: String
  studyId: String
  patientId: String
  hashKey: String
  armId: String
  eventGroupId: String
  eventId: String
  activityGroupId: String
  activityId: String
  eventDayOffset: Int
  eventTime: String
  questionId: String
  answers: String
}

type TaskAnswer @model @auth(rules: [{ allow: public }]) {
  id: ID!
  pk: String!
  sk: String!
  taskInstanceId: String
  activityId: String
  questionId: String
  answer: String
  hashKey: String
  syncState: Int
  syncStatus: String
}

type TaskResult @model @auth(rules: [{ allow: public }]) {
  id: ID!
  pk: String!
  sk: String!
  taskInstanceId: String
  status: String
  startedAt: String
  completedAt: String
  hashKey: String
  syncState: Int
  syncStatus: String
}

type TaskHistory @model @auth(rules: [{ allow: public }]) {
  id: ID!
  pk: String!
  sk: String!
  taskInstanceId: String
  status: String
  statusBeforeExpired: String
  timestamp: String
  action: String
  details: String
  hashKey: String
}

type TaskTempAnswer @model @auth(rules: [{ allow: public }]) {
  id: ID!
  pk: String!
  sk: String!
  taskPk: String!
  activityId: String!
  answers: AWSJSON!
  localtime: AWSDateTime!
  hashKey: String
}
